# Development Guide

This guide covers local setup, quality gates, and frontend/backend consistency checks for Neo Explorer UI.

## Prerequisites

- Node.js 18.x or 20.x
- npm 9+
- Optional for cross-repo validation: local backend checkout at `../neo3fura`

## Local Setup

```bash
git clone https://github.com/r3e-network/Neo-Explorer-UI.git
cd Neo-Explorer-UI
cp .env.example .env
npm install
npm run dev
```

The app runs at `http://localhost:5173`.

## Environment Variables

`.env` is optional for default behavior.

- `VITE_RPC_BASE_URL`: optional fixed RPC base URL override.
  - If unset, the UI uses network-aware base paths (`/api/mainnet` and `/api/testnet`).
  - If set, it bypasses the in-app network switch.

## Architecture Notes

- API access goes through `src/services/` (JSON-RPC requests via `src/services/api.js`).
- Network selection and API base-path logic live in `src/utils/env.js`.
- RPC method usage should be validated against backend APIs/docs before release.
- Developer API docs page method metadata is centralized in `src/constants/rpcApiDocs.mjs`.

## Quality Gates

```bash
# Lint
npm run lint

# Unit tests
npm test

# Build
npm run build

# Validate frontend RPC usage against backend API/docs
npm run validate:rpc
```

Combined check:

```bash
npm run qa
```

Full check with frontend/backend RPC consistency:

```bash
npm run qa:full
```

## Frontend/Backend RPC Consistency

`npm run validate:rpc` scans frontend RPC calls and compares them with:

- `neo3fura_http/config/config.go` API allowlist
- `neo3fura_http/biz/api` handlers
- `docs/api` backend docs

Override backend path if needed:

```bash
BACKEND_ROOT=/absolute/path/to/neo3fura npm run validate:rpc
```

Strict mode options:

- `FAIL_ON_FRONTEND_DOC_GAPS=1`: fail if frontend-used RPC methods are missing, mismatched, documented only by autogenerated placeholders, or mapped to reserved compatibility docs.
- `FAIL_ON_BACKEND_UNDOCUMENTED=1`: fail if backend allowlisted methods are missing docs.

Always-on guardrails:

- `validate:rpc` fails when frontend methods are missing in backend API allowlist.
- `validate:rpc` fails when frontend methods are missing concrete backend handlers in `neo3fura_http/biz/api`.
- `validate:rpc` fails when the API docs catalog (`src/constants/rpcApiDocs.mjs`) has structural drift (duplicate methods/categories or invalid passthrough typing).
- `validate:rpc` fails when API docs catalog methods are not referenced by frontend RPC usage.

Doc-sync options:

- `WRITE_MISSING_BACKEND_DOCS=1`: create stub files for allowlisted methods with missing docs.
- `REFRESH_AUTOGENERATED_BACKEND_DOCS=1`: refresh only previously auto-generated stubs (safe for hand-written docs).

Useful shortcuts:

```bash
# strict consistency check
npm run validate:rpc:strict

# generate/refresh backend doc stubs
npm run validate:rpc:sync-docs
```

## Testing Guidance

- Keep tests under `tests/` mirroring source behavior.
- For composables with lifecycle hooks, mount via a lightweight test component.
- Prefer deterministic tests with mocked RPC responses and fake timers for polling code.
